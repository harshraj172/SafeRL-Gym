/gpfs/project/6075961/domenic/SafeRL-Gym/src/train.py:24: DeprecationWarning: `np.bool8` is a deprecated alias for `np.bool_`.  (Deprecated NumPy 1.24)
  if not hasattr(np, 'bool8'):
/home/domenic/.local/lib/python3.10/site-packages/transformers/convert_slow_tokenizer.py:564: UserWarning: The sentencepiece tokenizer that you are converting to a fast tokenizer uses the byte fallback option which is not implemented in the fast tokenizers. In practice this means that the fast version of the tokenizer can produce unknown tokens whereas the sentencepiece version would have converted these unknown tokens into a sequence of byte tokens matching the original piece of text.
  warnings.warn(
  0%|          | 0/10000 [00:00<?, ?it/s]/home/domenic/.local/lib/python3.10/site-packages/torch/nested/__init__.py:228: UserWarning: The PyTorch API of nested tensors is in prototype stage and will change in the near future. We recommend specifying layout=torch.jagged when constructing a nested tensor, as this layout receives active development, has better operator coverage, and works with torch.compile. (Triggered internally at /shared_tmp/build_wheels_tmp.73843/python-3.10/torch/aten/src/ATen/NestedTensorImpl.cpp:178.)
  return _nested.nested_tensor(
  0%|          | 0/10000 [00:01<?, ?it/s]
Traceback (most recent call last):
  File "/cvmfs/soft.computecanada.ca/easybuild/software/2023/x86-64-v4/Compiler/gcccore/python/3.10.13/lib/python3.10/runpy.py", line 196, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/cvmfs/soft.computecanada.ca/easybuild/software/2023/x86-64-v4/Compiler/gcccore/python/3.10.13/lib/python3.10/runpy.py", line 86, in _run_code
    exec(code, run_globals)
  File "/gpfs/project/6075961/domenic/SafeRL-Gym/src/train.py", line 314, in <module>
    main()
  File "/gpfs/project/6075961/domenic/SafeRL-Gym/src/train.py", line 301, in main
    train(
  File "/gpfs/project/6075961/domenic/SafeRL-Gym/src/train.py", line 162, in train
    action_ids, action_idxs, _ = agent.act(
  File "/gpfs/project/6075961/domenic/SafeRL-Gym/src/agent/drrn.py", line 190, in act
    idxs = self.network.act(states, poss_acts, lm=lm, eps=args.eps, alpha=args.alpha, beta=args.beta)
  File "/home/domenic/.local/lib/python3.10/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
  File "/gpfs/project/6075961/domenic/SafeRL-Gym/src/agent/drrn.py", line 110, in act
    q_values = self.forward(states, valid_ids)
  File "/gpfs/project/6075961/domenic/SafeRL-Gym/src/agent/drrn.py", line 87, in forward
    inv_out = self.packed_rnn(
  File "/gpfs/project/6075961/domenic/SafeRL-Gym/src/agent/drrn.py", line 53, in packed_rnn
    _, out = rnn(inp)
  File "/home/domenic/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/domenic/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/domenic/.local/lib/python3.10/site-packages/torch/nn/modules/rnn.py", line 1391, in forward
    self.check_forward_args(input, hx, batch_sizes)
  File "/home/domenic/.local/lib/python3.10/site-packages/torch/nn/modules/rnn.py", line 363, in check_forward_args
    self.check_input(input, batch_sizes)
  File "/home/domenic/.local/lib/python3.10/site-packages/torch/nn/modules/rnn.py", line 314, in check_input
    raise RuntimeError(
RuntimeError: input.size(-1) must be equal to input_size. Expected 3, got 1
/gpfs/project/6075961/domenic/SafeRL-Gym/src/train.py:24: DeprecationWarning: `np.bool8` is a deprecated alias for `np.bool_`.  (Deprecated NumPy 1.24)
  if not hasattr(np, 'bool8'):
/home/domenic/.local/lib/python3.10/site-packages/transformers/convert_slow_tokenizer.py:564: UserWarning: The sentencepiece tokenizer that you are converting to a fast tokenizer uses the byte fallback option which is not implemented in the fast tokenizers. In practice this means that the fast version of the tokenizer can produce unknown tokens whereas the sentencepiece version would have converted these unknown tokens into a sequence of byte tokens matching the original piece of text.
  warnings.warn(
  0%|          | 0/10000 [00:00<?, ?it/s]/home/domenic/.local/lib/python3.10/site-packages/torch/nested/__init__.py:228: UserWarning: The PyTorch API of nested tensors is in prototype stage and will change in the near future. We recommend specifying layout=torch.jagged when constructing a nested tensor, as this layout receives active development, has better operator coverage, and works with torch.compile. (Triggered internally at /shared_tmp/build_wheels_tmp.73843/python-3.10/torch/aten/src/ATen/NestedTensorImpl.cpp:178.)
  return _nested.nested_tensor(
  0%|          | 0/10000 [00:00<?, ?it/s]
Traceback (most recent call last):
  File "/cvmfs/soft.computecanada.ca/easybuild/software/2023/x86-64-v4/Compiler/gcccore/python/3.10.13/lib/python3.10/runpy.py", line 196, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/cvmfs/soft.computecanada.ca/easybuild/software/2023/x86-64-v4/Compiler/gcccore/python/3.10.13/lib/python3.10/runpy.py", line 86, in _run_code
    exec(code, run_globals)
  File "/gpfs/project/6075961/domenic/SafeRL-Gym/src/train.py", line 314, in <module>
    main()
  File "/gpfs/project/6075961/domenic/SafeRL-Gym/src/train.py", line 301, in main
    train(
  File "/gpfs/project/6075961/domenic/SafeRL-Gym/src/train.py", line 162, in train
    action_ids, action_idxs, _ = agent.act(
  File "/gpfs/project/6075961/domenic/SafeRL-Gym/src/agent/drrn.py", line 190, in act
    idxs = self.network.act(states, poss_acts, lm=lm, eps=args.eps, alpha=args.alpha, beta=args.beta)
  File "/home/domenic/.local/lib/python3.10/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
  File "/gpfs/project/6075961/domenic/SafeRL-Gym/src/agent/drrn.py", line 110, in act
    q_values = self.forward(states, valid_ids)
  File "/gpfs/project/6075961/domenic/SafeRL-Gym/src/agent/drrn.py", line 87, in forward
    inv_out = self.packed_rnn(
  File "/gpfs/project/6075961/domenic/SafeRL-Gym/src/agent/drrn.py", line 53, in packed_rnn
    _, out = rnn(inp)
  File "/home/domenic/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/domenic/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/domenic/.local/lib/python3.10/site-packages/torch/nn/modules/rnn.py", line 1391, in forward
    self.check_forward_args(input, hx, batch_sizes)
  File "/home/domenic/.local/lib/python3.10/site-packages/torch/nn/modules/rnn.py", line 363, in check_forward_args
    self.check_input(input, batch_sizes)
  File "/home/domenic/.local/lib/python3.10/site-packages/torch/nn/modules/rnn.py", line 314, in check_input
    raise RuntimeError(
RuntimeError: input.size(-1) must be equal to input_size. Expected 3, got 1
/gpfs/project/6075961/domenic/SafeRL-Gym/src/train.py:24: DeprecationWarning: `np.bool8` is a deprecated alias for `np.bool_`.  (Deprecated NumPy 1.24)
  if not hasattr(np, 'bool8'):
/home/domenic/.local/lib/python3.10/site-packages/transformers/convert_slow_tokenizer.py:564: UserWarning: The sentencepiece tokenizer that you are converting to a fast tokenizer uses the byte fallback option which is not implemented in the fast tokenizers. In practice this means that the fast version of the tokenizer can produce unknown tokens whereas the sentencepiece version would have converted these unknown tokens into a sequence of byte tokens matching the original piece of text.
  warnings.warn(
  0%|          | 0/10000 [00:00<?, ?it/s]/home/domenic/.local/lib/python3.10/site-packages/torch/nested/__init__.py:228: UserWarning: The PyTorch API of nested tensors is in prototype stage and will change in the near future. We recommend specifying layout=torch.jagged when constructing a nested tensor, as this layout receives active development, has better operator coverage, and works with torch.compile. (Triggered internally at /shared_tmp/build_wheels_tmp.73843/python-3.10/torch/aten/src/ATen/NestedTensorImpl.cpp:178.)
  return _nested.nested_tensor(
  0%|          | 0/10000 [00:00<?, ?it/s]
Traceback (most recent call last):
  File "/cvmfs/soft.computecanada.ca/easybuild/software/2023/x86-64-v4/Compiler/gcccore/python/3.10.13/lib/python3.10/runpy.py", line 196, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/cvmfs/soft.computecanada.ca/easybuild/software/2023/x86-64-v4/Compiler/gcccore/python/3.10.13/lib/python3.10/runpy.py", line 86, in _run_code
    exec(code, run_globals)
  File "/gpfs/project/6075961/domenic/SafeRL-Gym/src/train.py", line 314, in <module>
    main()
  File "/gpfs/project/6075961/domenic/SafeRL-Gym/src/train.py", line 301, in main
    train(
  File "/gpfs/project/6075961/domenic/SafeRL-Gym/src/train.py", line 162, in train
    action_ids, action_idxs, _ = agent.act(
  File "/gpfs/project/6075961/domenic/SafeRL-Gym/src/agent/drrn.py", line 190, in act
    idxs = self.network.act(states, poss_acts, lm=lm, eps=args.eps, alpha=args.alpha, beta=args.beta)
  File "/home/domenic/.local/lib/python3.10/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
  File "/gpfs/project/6075961/domenic/SafeRL-Gym/src/agent/drrn.py", line 110, in act
    q_values = self.forward(states, valid_ids)
  File "/gpfs/project/6075961/domenic/SafeRL-Gym/src/agent/drrn.py", line 87, in forward
    inv_out = self.packed_rnn(
  File "/gpfs/project/6075961/domenic/SafeRL-Gym/src/agent/drrn.py", line 53, in packed_rnn
    _, out = rnn(inp)
  File "/home/domenic/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/domenic/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/domenic/.local/lib/python3.10/site-packages/torch/nn/modules/rnn.py", line 1391, in forward
    self.check_forward_args(input, hx, batch_sizes)
  File "/home/domenic/.local/lib/python3.10/site-packages/torch/nn/modules/rnn.py", line 363, in check_forward_args
    self.check_input(input, batch_sizes)
  File "/home/domenic/.local/lib/python3.10/site-packages/torch/nn/modules/rnn.py", line 314, in check_input
    raise RuntimeError(
RuntimeError: input.size(-1) must be equal to input_size. Expected 3, got 1
/gpfs/project/6075961/domenic/SafeRL-Gym/src/train.py:24: DeprecationWarning: `np.bool8` is a deprecated alias for `np.bool_`.  (Deprecated NumPy 1.24)
  if not hasattr(np, 'bool8'):
/home/domenic/.local/lib/python3.10/site-packages/transformers/convert_slow_tokenizer.py:564: UserWarning: The sentencepiece tokenizer that you are converting to a fast tokenizer uses the byte fallback option which is not implemented in the fast tokenizers. In practice this means that the fast version of the tokenizer can produce unknown tokens whereas the sentencepiece version would have converted these unknown tokens into a sequence of byte tokens matching the original piece of text.
  warnings.warn(
  0%|          | 0/10000 [00:00<?, ?it/s]/home/domenic/.local/lib/python3.10/site-packages/torch/nested/__init__.py:228: UserWarning: The PyTorch API of nested tensors is in prototype stage and will change in the near future. We recommend specifying layout=torch.jagged when constructing a nested tensor, as this layout receives active development, has better operator coverage, and works with torch.compile. (Triggered internally at /shared_tmp/build_wheels_tmp.73843/python-3.10/torch/aten/src/ATen/NestedTensorImpl.cpp:178.)
  return _nested.nested_tensor(
  0%|          | 0/10000 [00:00<?, ?it/s]
Traceback (most recent call last):
  File "/cvmfs/soft.computecanada.ca/easybuild/software/2023/x86-64-v4/Compiler/gcccore/python/3.10.13/lib/python3.10/runpy.py", line 196, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/cvmfs/soft.computecanada.ca/easybuild/software/2023/x86-64-v4/Compiler/gcccore/python/3.10.13/lib/python3.10/runpy.py", line 86, in _run_code
    exec(code, run_globals)
  File "/gpfs/project/6075961/domenic/SafeRL-Gym/src/train.py", line 314, in <module>
    main()
  File "/gpfs/project/6075961/domenic/SafeRL-Gym/src/train.py", line 301, in main
    train(
  File "/gpfs/project/6075961/domenic/SafeRL-Gym/src/train.py", line 162, in train
    action_ids, action_idxs, _ = agent.act(
  File "/gpfs/project/6075961/domenic/SafeRL-Gym/src/agent/drrn.py", line 190, in act
    idxs = self.network.act(states, poss_acts, lm=lm, eps=args.eps, alpha=args.alpha, beta=args.beta)
  File "/home/domenic/.local/lib/python3.10/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
  File "/gpfs/project/6075961/domenic/SafeRL-Gym/src/agent/drrn.py", line 110, in act
    q_values = self.forward(states, valid_ids)
  File "/gpfs/project/6075961/domenic/SafeRL-Gym/src/agent/drrn.py", line 87, in forward
    inv_out = self.packed_rnn(
  File "/gpfs/project/6075961/domenic/SafeRL-Gym/src/agent/drrn.py", line 53, in packed_rnn
    _, out = rnn(inp)
  File "/home/domenic/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/domenic/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/domenic/.local/lib/python3.10/site-packages/torch/nn/modules/rnn.py", line 1391, in forward
    self.check_forward_args(input, hx, batch_sizes)
  File "/home/domenic/.local/lib/python3.10/site-packages/torch/nn/modules/rnn.py", line 363, in check_forward_args
    self.check_input(input, batch_sizes)
  File "/home/domenic/.local/lib/python3.10/site-packages/torch/nn/modules/rnn.py", line 314, in check_input
    raise RuntimeError(
RuntimeError: input.size(-1) must be equal to input_size. Expected 3, got 1
/gpfs/project/6075961/domenic/SafeRL-Gym/src/train.py:24: DeprecationWarning: `np.bool8` is a deprecated alias for `np.bool_`.  (Deprecated NumPy 1.24)
  if not hasattr(np, 'bool8'):
/home/domenic/.local/lib/python3.10/site-packages/transformers/convert_slow_tokenizer.py:564: UserWarning: The sentencepiece tokenizer that you are converting to a fast tokenizer uses the byte fallback option which is not implemented in the fast tokenizers. In practice this means that the fast version of the tokenizer can produce unknown tokens whereas the sentencepiece version would have converted these unknown tokens into a sequence of byte tokens matching the original piece of text.
  warnings.warn(
  0%|          | 0/10000 [00:00<?, ?it/s]/home/domenic/.local/lib/python3.10/site-packages/torch/nested/__init__.py:228: UserWarning: The PyTorch API of nested tensors is in prototype stage and will change in the near future. We recommend specifying layout=torch.jagged when constructing a nested tensor, as this layout receives active development, has better operator coverage, and works with torch.compile. (Triggered internally at /shared_tmp/build_wheels_tmp.73843/python-3.10/torch/aten/src/ATen/NestedTensorImpl.cpp:178.)
  return _nested.nested_tensor(
  0%|          | 0/10000 [00:00<?, ?it/s]
Traceback (most recent call last):
  File "/cvmfs/soft.computecanada.ca/easybuild/software/2023/x86-64-v4/Compiler/gcccore/python/3.10.13/lib/python3.10/runpy.py", line 196, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/cvmfs/soft.computecanada.ca/easybuild/software/2023/x86-64-v4/Compiler/gcccore/python/3.10.13/lib/python3.10/runpy.py", line 86, in _run_code
    exec(code, run_globals)
  File "/gpfs/project/6075961/domenic/SafeRL-Gym/src/train.py", line 314, in <module>
    main()
  File "/gpfs/project/6075961/domenic/SafeRL-Gym/src/train.py", line 301, in main
    train(
  File "/gpfs/project/6075961/domenic/SafeRL-Gym/src/train.py", line 162, in train
    action_ids, action_idxs, _ = agent.act(
  File "/gpfs/project/6075961/domenic/SafeRL-Gym/src/agent/drrn.py", line 190, in act
    idxs = self.network.act(states, poss_acts, lm=lm, eps=args.eps, alpha=args.alpha, beta=args.beta)
  File "/home/domenic/.local/lib/python3.10/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
  File "/gpfs/project/6075961/domenic/SafeRL-Gym/src/agent/drrn.py", line 110, in act
    q_values = self.forward(states, valid_ids)
  File "/gpfs/project/6075961/domenic/SafeRL-Gym/src/agent/drrn.py", line 87, in forward
    inv_out = self.packed_rnn(
  File "/gpfs/project/6075961/domenic/SafeRL-Gym/src/agent/drrn.py", line 53, in packed_rnn
    _, out = rnn(inp)
  File "/home/domenic/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/domenic/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/domenic/.local/lib/python3.10/site-packages/torch/nn/modules/rnn.py", line 1391, in forward
    self.check_forward_args(input, hx, batch_sizes)
  File "/home/domenic/.local/lib/python3.10/site-packages/torch/nn/modules/rnn.py", line 363, in check_forward_args
    self.check_input(input, batch_sizes)
  File "/home/domenic/.local/lib/python3.10/site-packages/torch/nn/modules/rnn.py", line 314, in check_input
    raise RuntimeError(
RuntimeError: input.size(-1) must be equal to input_size. Expected 3, got 1
/gpfs/project/6075961/domenic/SafeRL-Gym/src/train.py:24: DeprecationWarning: `np.bool8` is a deprecated alias for `np.bool_`.  (Deprecated NumPy 1.24)
  if not hasattr(np, 'bool8'):
/home/domenic/.local/lib/python3.10/site-packages/transformers/convert_slow_tokenizer.py:564: UserWarning: The sentencepiece tokenizer that you are converting to a fast tokenizer uses the byte fallback option which is not implemented in the fast tokenizers. In practice this means that the fast version of the tokenizer can produce unknown tokens whereas the sentencepiece version would have converted these unknown tokens into a sequence of byte tokens matching the original piece of text.
  warnings.warn(
  0%|          | 0/10000 [00:00<?, ?it/s]/home/domenic/.local/lib/python3.10/site-packages/torch/nested/__init__.py:228: UserWarning: The PyTorch API of nested tensors is in prototype stage and will change in the near future. We recommend specifying layout=torch.jagged when constructing a nested tensor, as this layout receives active development, has better operator coverage, and works with torch.compile. (Triggered internally at /shared_tmp/build_wheels_tmp.73843/python-3.10/torch/aten/src/ATen/NestedTensorImpl.cpp:178.)
  return _nested.nested_tensor(
  0%|          | 0/10000 [00:00<?, ?it/s]
Traceback (most recent call last):
  File "/cvmfs/soft.computecanada.ca/easybuild/software/2023/x86-64-v4/Compiler/gcccore/python/3.10.13/lib/python3.10/runpy.py", line 196, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/cvmfs/soft.computecanada.ca/easybuild/software/2023/x86-64-v4/Compiler/gcccore/python/3.10.13/lib/python3.10/runpy.py", line 86, in _run_code
    exec(code, run_globals)
  File "/gpfs/project/6075961/domenic/SafeRL-Gym/src/train.py", line 314, in <module>
    main()
  File "/gpfs/project/6075961/domenic/SafeRL-Gym/src/train.py", line 301, in main
    train(
  File "/gpfs/project/6075961/domenic/SafeRL-Gym/src/train.py", line 162, in train
    action_ids, action_idxs, _ = agent.act(
  File "/gpfs/project/6075961/domenic/SafeRL-Gym/src/agent/drrn.py", line 190, in act
    idxs = self.network.act(states, poss_acts, lm=lm, eps=args.eps, alpha=args.alpha, beta=args.beta)
  File "/home/domenic/.local/lib/python3.10/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
  File "/gpfs/project/6075961/domenic/SafeRL-Gym/src/agent/drrn.py", line 110, in act
    q_values = self.forward(states, valid_ids)
  File "/gpfs/project/6075961/domenic/SafeRL-Gym/src/agent/drrn.py", line 87, in forward
    inv_out = self.packed_rnn(
  File "/gpfs/project/6075961/domenic/SafeRL-Gym/src/agent/drrn.py", line 53, in packed_rnn
    _, out = rnn(inp)
  File "/home/domenic/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/domenic/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/domenic/.local/lib/python3.10/site-packages/torch/nn/modules/rnn.py", line 1391, in forward
    self.check_forward_args(input, hx, batch_sizes)
  File "/home/domenic/.local/lib/python3.10/site-packages/torch/nn/modules/rnn.py", line 363, in check_forward_args
    self.check_input(input, batch_sizes)
  File "/home/domenic/.local/lib/python3.10/site-packages/torch/nn/modules/rnn.py", line 314, in check_input
    raise RuntimeError(
RuntimeError: input.size(-1) must be equal to input_size. Expected 3, got 1
/gpfs/project/6075961/domenic/SafeRL-Gym/src/train.py:24: DeprecationWarning: `np.bool8` is a deprecated alias for `np.bool_`.  (Deprecated NumPy 1.24)
  if not hasattr(np, 'bool8'):
/home/domenic/.local/lib/python3.10/site-packages/transformers/convert_slow_tokenizer.py:564: UserWarning: The sentencepiece tokenizer that you are converting to a fast tokenizer uses the byte fallback option which is not implemented in the fast tokenizers. In practice this means that the fast version of the tokenizer can produce unknown tokens whereas the sentencepiece version would have converted these unknown tokens into a sequence of byte tokens matching the original piece of text.
  warnings.warn(
  0%|          | 0/10000 [00:00<?, ?it/s]/home/domenic/.local/lib/python3.10/site-packages/torch/nested/__init__.py:228: UserWarning: The PyTorch API of nested tensors is in prototype stage and will change in the near future. We recommend specifying layout=torch.jagged when constructing a nested tensor, as this layout receives active development, has better operator coverage, and works with torch.compile. (Triggered internally at /shared_tmp/build_wheels_tmp.73843/python-3.10/torch/aten/src/ATen/NestedTensorImpl.cpp:178.)
  return _nested.nested_tensor(
  0%|          | 0/10000 [00:00<?, ?it/s]
Traceback (most recent call last):
  File "/cvmfs/soft.computecanada.ca/easybuild/software/2023/x86-64-v4/Compiler/gcccore/python/3.10.13/lib/python3.10/runpy.py", line 196, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/cvmfs/soft.computecanada.ca/easybuild/software/2023/x86-64-v4/Compiler/gcccore/python/3.10.13/lib/python3.10/runpy.py", line 86, in _run_code
    exec(code, run_globals)
  File "/gpfs/project/6075961/domenic/SafeRL-Gym/src/train.py", line 314, in <module>
    main()
  File "/gpfs/project/6075961/domenic/SafeRL-Gym/src/train.py", line 301, in main
    train(
  File "/gpfs/project/6075961/domenic/SafeRL-Gym/src/train.py", line 162, in train
    action_ids, action_idxs, _ = agent.act(
  File "/gpfs/project/6075961/domenic/SafeRL-Gym/src/agent/drrn.py", line 190, in act
    idxs = self.network.act(states, poss_acts, lm=lm, eps=args.eps, alpha=args.alpha, beta=args.beta)
  File "/home/domenic/.local/lib/python3.10/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
  File "/gpfs/project/6075961/domenic/SafeRL-Gym/src/agent/drrn.py", line 110, in act
    q_values = self.forward(states, valid_ids)
  File "/gpfs/project/6075961/domenic/SafeRL-Gym/src/agent/drrn.py", line 87, in forward
    inv_out = self.packed_rnn(
  File "/gpfs/project/6075961/domenic/SafeRL-Gym/src/agent/drrn.py", line 53, in packed_rnn
    _, out = rnn(inp)
  File "/home/domenic/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/domenic/.local/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/domenic/.local/lib/python3.10/site-packages/torch/nn/modules/rnn.py", line 1391, in forward
    self.check_forward_args(input, hx, batch_sizes)
  File "/home/domenic/.local/lib/python3.10/site-packages/torch/nn/modules/rnn.py", line 363, in check_forward_args
    self.check_input(input, batch_sizes)
  File "/home/domenic/.local/lib/python3.10/site-packages/torch/nn/modules/rnn.py", line 314, in check_input
    raise RuntimeError(
RuntimeError: input.size(-1) must be equal to input_size. Expected 3, got 1
